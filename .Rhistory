geom_line(linetype = "longdash", color = "red", size = 2)
# Change linetype and color according to a variable:
ggplot(data = w_date, aes(x = Date, y = Weekly_Sales, group = Store)) +
geom_line(aes(linetype = factor(Store), color = factor(Store)), size = 2) +
theme_minimal() +
geom_point(size = 3, aes(shape = factor(Store)))
# Horizontal and Vertical Lines
ggplot(data = w_date, aes(x = Date, y = Weekly_Sales, group = factor(Store))) +
geom_line(aes(linetype = factor(Store), color = factor(Store)), size = 2) +
geom_point(size = 3, aes(shape = factor(Store))) +
theme_minimal() +
geom_line(aes(y = 22500), color = "green3") + # add vertical line
geom_line(aes(x = as.Date("2012-08-09")), color = "green3") # add horizontal line
ggplot(data = w_date, aes(x = Date, y = Weekly_Sales, group = Store)) +
geom_line(aes(linetype = factor(Store), color = factor(Store)), size = 2) +
geom_point(size = 3, aes(shape = factor(Store))) +
theme_minimal() +
geom_hline(yintercept = 22500, color = "red")+ # add vertical line
geom_vline(xintercept = as.numeric(as.Date("2012-08-09")),color = "steelblue", size = 1.5) # add horizontal line
# The `geom_rect` geometry allows us to position rectangles directly on our plot.
# Such rectangles can be used to e.g. mark weekly sales results. Let's try to use
# `geom_rect` to show weeks in which sales have dropped:
# At first, calculate mean sales:
stat <- w_date %>%
filter(Store == 1) %>%
group_by(Date) %>%
summarise(Weekly_Sales = mean(Weekly_Sales))
# Create a data.frame to hold the marked areas:
df = data.frame(ymin = -Inf,
ymax = Inf,
xmin = c("2012-06-01", "2012-06-08", "2012-06-29", "2012-07-06", "2012-07-27", "2012-08-03", "2012-08-10", "2012-08-17", "2012-08-24", "2012-09-14"),
xmax = c("2012-06-08", "2012-06-29", "2012-07-06", "2012-07-27", "2012-08-03", "2012-08-10", "2012-08-17", "2012-08-24", "2012-09-14", "2012-09-28"),
trend = factor(c('rise', 'fall', 'rise', 'fall', 'rise', 'fall', 'rise', 'fall', 'rise', 'fall')))
# Create the plot:
ggplot(data = stat, aes(x = Date, y = Weekly_Sales)) +
geom_rect(data = df,
aes(xmin = as.Date(xmin), ymin = ymin,
xmax = as.Date(xmax), ymax = ymax,
fill = trend),
alpha = .4,
inherit.aes = F) +
geom_line(color = 'steelblue', size = 1.25) +
theme_minimal()
# First prepare the data:
stat <- w_date %>%
filter(Store == 1) %>% # choose single series
group_by(Date) %>% # group according to date
summarise(Weekly_Sales = mean(Weekly_Sales), # mean weekly sales
Fuel_Price = mean(Fuel_Price) # mean fuel price
)
# Prepare the plot:
p <- ggplot(data = stat, aes(x = Date)) +
geom_line(aes(y = Weekly_Sales), color = "steelblue", size = 1.25) + # I series
geom_line(aes(y = Fuel_Price*5000), color = "red", size = 1.25) + # II series (scaled-up)
theme_minimal() +
# create the second axis and reverse the transformation
scale_y_continuous(sec.axis = sec_axis(~./5000, name = 'Fuel Price'))
p
# Solution 1. Labelling
p +
scale_y_continuous(sec.axis = sec_axis(~./5000, name = 'Fuel Price (red)')) +
labs(subtitle = 'Weekly sales (left axis), Fuel Price (right axis)',
y = 'Weekly Sales (blue)')
# Solution 2. Colouring axis
p +
theme(
axis.text.y.left = element_text(color = 'steelblue', face = 'bold'),
axis.text.y.right = element_text(color = 'red', face = 'bold'),
axis.title.y.left = element_text(color = 'steelblue', face = 'bold'),
axis.title.y.right = element_text(color = 'red', face = 'bold')
)
# Solution 3. Creating legend manually.
ggplot(data = stat, aes(x = Date)) +
geom_line(aes(y = Weekly_Sales, color = "Weekly Sales (left axis)"), size = 1.25) + # I series
geom_line(aes(y = Fuel_Price*5000, color = "Fuel Price (right axis)"), size = 1.25) + # II series (scaled-up)
theme_minimal() +
scale_y_continuous(sec.axis = sec_axis(~./5000, name = 'Fuel Price')) +
theme(legend.position = 'top') +
labs(color = NULL) +
scale_color_manual(values = c('red', 'steelblue'))
# install.packages("quantmod")
library(quantmod)
# Then, using the `getSymbols()` function we can download the data of interest.
# The first argument of this function is the __ticker symbol__, which is a unique
# shortcut used to label the company in a given index, which can be found e.g.
# https://en.wikipedia.org/wiki/List_of_S%26P_500_companies). The `src="yahoo"`
# labels the data source, while `from=` and `to=` are used to pick the time range
# of the data. The `getSymbols()` function does not return anything useful --
# it creates an object with the name of the first argument directly in the global scope
# (which is a very bad practise and we do not recommend to do that in your code).
# The object created is of class `xts` and `zoo` which are used as basic types to
# deal with the time series.
start <- Sys.time() - 100*(60*60*24) #today - 100 days
end <- Sys.time() #today
getSymbols("GOOGL", src = "yahoo", from = start, to = end) #Check the data for GOOGLE
# Convert to data.frame:
GOOGL <- as.data.frame(GOOGL)
GOOGL$Date <- as.Date(rownames(GOOGL))
# The closing price is located in the fourth column of the `GOOGL` object. Let's
# create the `plot_GOOGL` object to ease the further work:
plot_GOOGL <- ggplot(GOOGL, aes(x = Date, y = GOOGL.Close)) + geom_line()
plot_GOOGL
# Riverplot:
plot_GOOGL <- ggplot(GOOGL, aes(x = Date, y = GOOGL.Close, size = GOOGL.Volume)) + geom_line()
# Upload packages to memory
library(ggplot2)
library(dplyr)
library(tidyr)
library(lubridate)
library(readr)
# import data
load('data/Walmart.Rdata')
w_store
setwd("C:/Users/hajiy/Desktop/Advanced Visualisation in R")
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value),  label = paste0("â¬", Value, "M"))) +
geom_line() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value),  label = paste0("â¬", Value, "M"))) +
geom_line() +
geom_point() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 20, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value),  label = paste0("â¬", Value, "M"))) +
geom_line() +
geom_point() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value),  label = paste0("â¬", Value, "M"))) +
geom_line() +
geom_point() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value),  label = paste0("â¬", Value, "M"))) +
geom_line() +
geom_point() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value), group = Class)) +
geom_line() +
geom_point() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value))) +
geom_line() +
geom_point() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value), group = Class)) +
geom_line() +
geom_point() +
facet_wrap(Class~., scales = "free")+
theme(axis.text.x=element_blank(),
strip.background =element_rect(fill="gray"),
strip.text.x = element_text(size = 10, colour = "white",face = "bold.italic"))+
theme_minimal() +labs(title = "Most Valuable Players", x = NULL, y = NULL)
View(ax)
View(numofplayers)
View(md_new)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value), group = Potential)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(Value, reorder(Name, Value), group = Class, color = Potential)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
runApp('C:/Users/hajiy/Desktop/Fifa_19_Project')
runApp('C:/Users/hajiy/Desktop/Fifa_19_Project')
runApp()
setwd("C:/Users/hajiy/Desktop/Fifa_19_Project")
runApp()
runApp()
ggplotly(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class,
color = Potential
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
ggplotly(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class,
color = Potential
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
ggplotly(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
ggplotly(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class,
label = paste0("â¬", Values / 1000000, "M")
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
ggplotly(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class,
label = paste0("â¬", Values / 1000000, "M")
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class,
label = paste0("â¬", Value, "M")
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
axis.text.x = element_blank(),
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = NULL, y = NULL)
ggplotly(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = "Million €", y = NULL)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
reorder(Name, Value),
group = Class
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = "Million €", y = NULL)
ggplotly(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
reorder(Name, Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
Name,
group = Class
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = "Million €", y = NULL)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
reorder(Name, Value) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
Name,
group = Class
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = "Million €", y = NULL)
View(a)
a <- md %>%
filter(League == "La Liga" & Class == "Midfielder") %>%
arrange(-Value) %>%
mutate(Name = reorder(Name, Value)) %>%
top_n(n = 10, wt = Value) %>%
ggplot(aes(
Value,
Name,
group = Class
)) +
geom_line() +
geom_point() +
facet_wrap(Class ~ ., scales = "free") +
theme(
strip.background = element_rect(fill = "gray"),
strip.text.x = element_text(
size = 10,
colour = "white",
face = "bold.italic"
)
) +
theme_minimal() + labs(title = "Most Valuable Players", x = "Million €", y = NULL)
ggplotly(a)
setwd("C:/Users/hajiy/Desktop/Fifa_19_Project")
runApp()
runApp()
runApp()
